<!DOCTYPE html>
<html lang="en">
<!-- 
 * ServerHub Doc Page
 * 
 * ServerHub MVC Doc, MIT License
 * March 15, 2018
 * Yang Zhongdong (yangzd1996@outlook.com)
 -->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Instance.Run() 方法</title>
    <link rel="stylesheet" href="../../contents/index.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
</head>

<body>

    <header>
        <div class="serverhub-logo">
            <img src="../../assets/serverhub-compact.png" alt="ServerHub Logo">
        </div>
    </header>
    <main>
        <div class="content">
            <h2>Instance.Run() 方法</h2>
            <p>这里将给出一个简单的目录，包含了 ServerHub 正常启动所需要的各个基本路径：（你可以通过 NPM 上的 serverhub-cli 工具来生成此目录）</p>
            <p>
                <div class="non-list-style ul-directory">
                    <ul>demo_directory/
                        <li>
                            <ul>controller/
                                <li>home.js</li>
                            </ul>
                        </li>
                        <li>
                            <ul>model/
                                <li>home.json</li>
                            </ul>
                        </li>
                        <li>
                            <ul>view/
                                <li>home.html</li>
                            </ul>
                        </li>
                        <li>
                            <ul>www/
                                <span class="comment">// web 目录</span>
                                <li>global.css</li>
                                <li>global.js</li>
                            </ul>
                        </li>
                        <li>app.js
                            <span class="comment">// ServerHub 入口函数</span>
                        </li>
                    </ul>
                </div>
            </p>
            <p>现在，我们对
                <code>app.js</code> 做一些修改。</p>
            <h3>配置启动参数</h3>
            <p>在你的
                <code>app.js</code>中，可以看到类似于下面例子的代码：</p>
            <p>
                <pre><code class="js">const serverhub = require('serverhub-mvc');
const fs = require('fs');
const path = require('path');

serverhub.Run({
    BaseDir: __dirname,
    WebDir: 'www/',
    Controllers: ['home.js'],
    MaxCacheSize: 256 // unit: MB
}, (route) => {
    route.MapRoute('default', '{controller}/{action}/{id}', {
        Controller: 'home',
        Action: 'index',
        id: ''
    });
});</code></pre>
            </p>
            <p>
                <code>Run()</code> 方法需要两个参数：</p>
            <p>
                <ul>
                    <li>
                        <code>config</code>
                        <p>此参数定义了服务器的根目录，也就是 <code>app.js</code> 所在的目录。该参数中有一个
                            <code>Controller</code> 属性指定了你要注册的控制器（也就是 controller 目录下的文件）。</p>
                        <p>ServerHub 在启动时（称作 Compile-time，以后会提到这个词）会尝试找到并解析、注册这些文件。当你写 config 参数时，可以参阅<code>node_modules/serverhub-mvc/index.d.ts</code> 中的类型定义。我使用 TypeScript 来开发，所以在一些现代编辑器中，你可以得到详细的类型推断、提示。此时，你不需要知道太多参数属性的含义，因为它们会在后续的文档中得到解释说明。</p>
                    </li>
                    <li>
                        <code>route</code>（回调函数形式）
                        <p>此函数用于注册路由，你可以通过它来注册或是添加路由例外。具体使用方法，我们会在以后的文档中详细说明。
                        </p>
                    </li>
                </ul>
            </p>
            <p>现在，尝试运行
                <code>node app.js</code>，ServerHub 会启动并监听 926 端口（是一个生日）。</p>
        </div>
    </main>
    <footer>
        <span>By
            <a href="mailto:yangzd1996@outlook.com">DevChache</a> at
            <a href="https://github.com/DevChache">GitHub</a>,
            <span class='g800-only'>dedicates to my beloved</span>
            <span class="s800-only">for beloved</span>
            <i>Changrui Yang</i>
        </span>
    </footer>
    <script src="../../scripts/index.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</body>

</html>